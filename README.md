# Normal Copula Model


As a well known default correlation model, the normal copula provides an alternative method to the Poisson model in generating correlated default events of a collateral pool. It is implemented using the Monte Carlo (MC) simulation.  The testing was conducted by implementing an independent test model using the MC simulation. The results of two sample trades, generated by the test model and the model, respectively, were compared. The MC implementation was also verified by the closed form solutions and the Poisson model.

The model implements the normal copula which is a default correlation model. Implemented by Monte Carlo (MC) simulation, the model generates correlated default events of a collateral pool of obligors, hence can be used to value basket default swaps and Collateral Debt Obligations (CDOs) (nofm basket, FirstLoss, Caribou, and MezzMezzMezz). 

A copula is a mathematical function that combines marginal probability into a joint distribution. For n uniform random variables,  , the joint distribution function is defined as

 

which is called Copula function.

The normal copula function is a multi-variate cumulative normal distribution with correlation matrix  . Applying the normal copula function to the modeling of correlated default events of a collateral asset pool, the uniform random variables are mapped to the default probabilities with standard normal distribution. The normal copula function, or the cumulative joint default probability for the collateral pool with n assets, can be expressed as

 

where   is the standard cumulative normal distribution function and the default probability of the ith obligor reads

 

where  is the hazard rate of the ith obligor in the collateral pool. For a collateral pool with n assets, the normal copula function is actually an n-dimensional integral, which is hard to calculate directly if n is large.

The spreadsheet normal copula model is implemented by employing MC simulation. In order to generate correlated defaults times using normal copula, a series of random variables   are first generated from an n-dimensional normal distribution with correlation   in each MC scenario. The default times for each obligor in the collateral pool   are obtained using

 

Apart from the MC simulation, there is a way to reduce the dimension of the closed form solution called one factor normal copula under certain assumptions. For the ith obligor in the collateral pool, we assume that its asset process follows  , where  ,  are independent standard Gaussian random variables.  The asset correlation between ith and jth obligor is known as 

 .

Then the Normal copula can be proved to have the form

 .

The n-dimensional copula is computed through a one-dimensional integral. The assumption that   is valid for a flat correlation matrix by assuming  .

Along with the normal copula implementation, the spreadsheet model has changed the way of generating interest rate curves and credit curves. The interest rate curves and credit spreads are retrieved directly from the Infinity database. The credit curve is calculated using a C++ dll function in which the same algorithm and methodology as that of Infinity is employed. This new implementation will bring interest rate curve and the credit curve generation in the spreadsheet model consistent with Infinity. The new implementation is also much faster than the original curve generation implementation of the spreadsheet model.

Because the obligors in the collateral pool of the test trade are homogeneous with flat correlation, we could value the trade using one factor normal copula model. 

In the test trade the principal of the first tranche equals loss given default (LGD) of the obligor ($6,000,000). This makes the value of protection for the first tranche equivalent to that of a first to default basket. According to the theory shown above, the joint survival function of the first to default event for a collateral pool with n obligors is provided by

 .

Hence the value of protection has the following closed form solution

 .

  is the discount factor,   is the maturity of the trade,   is the notional of the first tranche, and   is the recovery rate of the obligor.  is the hazard rate for the first to default event calculated by

 .


Both the normal copula model and the Poisson model are default correlation models used to generate correlated default events of a collateral pool. They are quite different in theory and MC implementation, although they use exactly same credit curves and asset correlation as the input. 

However, when the asset correlation is zero, each obligor is independent and there is no correlated default event at all. On the other hand, if the obligors are assumed to be homogenous, as the case of the test trade, and the asset correlation is assumed to be one, all the obligors in the collateral pool are perfectly correlated and should behave like one obligor. In a scenario either all the obligors default at the same time or no one defaults.  In such two cases, same results should be predicted no matter what default correlation models are employed.  

Implemented by the MC simulation, the submitted normal copula model generates correlated default events of a collateral pool, hence can be used to value basket default swaps and Collateral Debt Obligations (CDO) (nofm basket, FirstLoss, Caribou, and MezzMezzMezz). Our tests have shown that the model is implemented. The MC simulation is also tested against the closed form solutions and the agreement is excellent, showing that MC simulation in the model is implemented correctly (see https://finpricing.com/lib/FiBond.html). 

The normal copula model provides an alternative default correlation model to the Poisson model. They are quite different in theory and MC implementation, although they use exactly same credit curves and asset correlation as the input. However, in certain limits of the correlation both models should predict same results. Our tests have shown that the two models are indeed consistent when the correlation is zero and one for a homogeneous collateral pool.

In the submitted spreadsheet model the interest rate curves and credit spreads are retrieved directly from the Infinity database, and the credit spread is calculated using a C++ dll function in which the same algorithm and methodology as that of Infinity is employed. Using Maple 9 as the test deal, we have found that values of the interest rate curves and credit curves, generated by the spreadsheet model and Infinity, respectively, are exactly same. However, a very small discrepancy, which is well within the range of the MC simulation noises, can be observed between the results generated by the submitted version and the previous version of spreadsheet model. Most probably the difference comes from a small difference between the interest rate curves generated by the CMKT and the Infinity. The previous version of the spreadsheet model uses the CMKT engine to generate the interest rate curves. This minor difference does not impact the use of the model in any material way.

